# Maintainer: Bardia Moshiri <fakeshell@bardia.tech>

pkgname=lxc-android
pkgver=1.0
pkgrel=1
arch="all"
url="https://halium.org"
license="Apache"
depends="lxc shadow"
install="$pkgname.post-install"
source="lib/udev/rules.d/65-android.rules
	lib/udev/rules.d/99-android.rules
	usr/lib/android-tools-adbd/pre-start
	usr/bin/mount-android.sh
	usr/lib/lxc-android/mount-android
	usr/lib/lxc-android/lxc-android-stop
	usr/lib/lxc-android/lxc-android-notify
	var/lib/lxc/android/config
	var/lib/lxc/android/pre-start.sh
	etc/init.d/lxc-android
	etc/init.d/android-mount
	lxc-android.post-install"

pkgdesc="Configuration for starting Halium container"
options="!check"

builddir="$srcdir/$pkgname-$_commit"

package() {
	install -d ${pkgdir}/usr/lib/udev/rules.d/
	install -m 644 $srcdir/65-android.rules ${pkgdir}/usr/lib/udev/rules.d/
	install -m 644 $srcdir/99-android.rules ${pkgdir}/usr/lib/udev/rules.d/

	install -d ${pkgdir}/usr/lib/android-tools-adbd/
	install -m 755 $srcdir/pre-start ${pkgdir}/usr/lib/android-tools-adbd/

	install -d ${pkgdir}/usr/bin
	install -m 755 $srcdir/mount-android.sh ${pkgdir}/usr/bin/mount-android.sh

	install -d ${pkgdir}/usr/lib/lxc-android/
	install -m 755 $srcdir/mount-android ${pkgdir}/usr/lib/lxc-android/
	install -m 755 $srcdir/lxc-android-stop ${pkgdir}/usr/lib/lxc-android/
	install -m 755 $srcdir/lxc-android-notify ${pkgdir}/usr/lib/lxc-android/

	install -d ${pkgdir}/var/lib/lxc/android/rootfs
	install -m 644 $srcdir/config ${pkgdir}/var/lib/lxc/android/
	install -m 755 $srcdir/pre-start.sh ${pkgdir}/var/lib/lxc/android/
    
        install -Dm755 "$srcdir/lxc-android" "$pkgdir/etc/init.d/lxc-android"
        install -Dm755 "$srcdir/android-mount" "$pkgdir/etc/init.d/android-mount"


	ln -s /android/apex ${pkgdir}/apex
	ln -s /android/vendor ${pkgdir}/vendor
}
sha512sums="
8dea347c6585e710898bd02eb860245a191053df224a3cbe69bda370bdf0564a706b502914250111ce1aef517039b4f75c849b384c7d45ba750fe50794a84199  65-android.rules
f304daa77b6714e70bc60382717ad8a6803d85545d992457a6e598b3444a3d0db62c478e2452342d22254c61cdc286259708f8c16b7313cd95590f5afa581fbf  99-android.rules
48ed509ed3b6c7a2090e62f77c0271b0db9c49589ee0d3cbc84290afe5a1828393bcf5fa2ad7d1a5a1e0b8b80ddfea49e1e0461b5c4c8c6e24a5b5aa81575466  pre-start
4378ab5efa80a268d04eaa761bd786297738261fa140af1c345a805ea6b2327cf1b3c0c5e7c2318e0f1146e6dc1ae9c827494b3bfb7e9de4e1201654200ae4bf  mount-android.sh
16160035b20601fe084a6a9d4e8d59bda6bceb9c9475432ca2550e4a508643e05dd8d2ded3ba0a8bdb16407349f7dbdd064b44fc96f5fdf22a6826f9dd5c72d2  mount-android
952c09be32501c5596e86d5599704409c8958553524c8d5d1540caa911a5a68187a3abac8d65d7c3e98aa0cfc07a06cee0f0437a79034873ad2094797938883a  lxc-android-stop
444eed8b492d1bce2f8450ff339f8c727e325a7535d2bbb10aa062af33704eb9c7353540b95378c3462f22fcc75bcee2c2ea1cd0d92d6b8ced918a49913dd1e7  lxc-android-notify
891db78b0e008d8633c40f2dd538e9f60b84f55ad53b4f3b124518cf223d69aea5accf749fd9b13fe691514df900d88564336d45190b3dd88766e7f4e834634d  config
41a9e02dbeb5f295515da5dbeac57bd1952f00df7b3dd80dc36a2be5f2cfe19af3ea72b58cc4bc2a35b8de4167a33efd8979bd3ffde2cfbd13857473f5a6f6ef  pre-start.sh
8ee45ce35b2f619eecd5bc8d8297c5eaff25c181aeed19cc49cd69341c357d4b25633d7a4045ac04759a6e0e92340fa4e754246a0f7abd8caea53174a30cb674  lxc-android
50977f3d336edc2c57b02f395ce925b7ee8ace5aa6e5e7162aa364015d2ea68a03fc83f0fa60ec96469b04ca390321d26b37cc93229eca173a6cabecd92ce614  android-mount
8f9576c9ee510ce49f794f92edc88fd5f4b2d53abb9a560450dfbf43dea6add7b7996006942b64dc9ba57239a4727f824484c3768eb54ba2da2d8ad68d069f05  lxc-android.post-install
"
