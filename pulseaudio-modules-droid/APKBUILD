# Maintainer: Bardia Moshiri <fakeshell@bardia.tech>

pkgname=pulseaudio-modules-droid
pkgver=97
pkgrel=0
pkgdesc="pulseaudio-modules-droid (Android 11+)"
arch="all"
url="https://github.com/mer-hybris/pulseaudio-modules-droid-hidl"
license="GPL2"
depends="pulseaudio audiosystem-passthrough libevdev"
makedepends="meson pkgconf libhybris android-headers pulsecore-headers
	automake autoconf pulseaudio-dev libpulse"
options="!check"
_commit="cef8f787463e23932cf06899a85a88192a61dcec"
source="$pkgname-$_commit.tar.gz::https://github.com/droidian/pulseaudio-modules-droid/archive/$_commit.tar.gz"

builddir="$srcdir/$pkgname-$_commit"

build() {
	echo 15.0 > .tarball-version
	./bootstrap.sh
	./configure --disable-static \
	   --prefix=/usr --mandir=/usr/share/man --libdir=/usr/lib \
	   --sysconfdir=/etc --localstatedir=/var --sbindir=/usr/bin
	make KEEP_SYMBOLS=1 all
}

package() {
	make DESTDIR="$pkgdir/" install
}
